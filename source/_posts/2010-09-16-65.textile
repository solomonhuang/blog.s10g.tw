---
layout: post
title: '格式化cvs status的script'
date: 2010-9-16
wordpress_id: 65
permalink: /blogs/65
comments: true
---
之前為了很明瞭的明白cvs管理的檔案發生了什麼修改與變化。寫了一個script來處理cvs status的訊息。本script會濾掉沒有修改的檔案，會將沒有在cvs控管下的檔案標示出來。
<pre class="brush: shell">#!/bin/bash
TMPFILE="/tmp/cvsst-tmpfile-${USERNAME}-$(date +%s)"
cvs status &gt;${TMPFILE} 2&gt;/dev/null
cat ${TMPFILE} | grep -v ^\? | grep -v ^$ | grep -v ^=*=$ | \
  sed -e '/Up-to-date/,+5d' -e '/Sticky/d' \
  -e 's|^File: \(.*\)\(.\sStatus:\)\(.*\)$|\\nFile: \\e[0;1;33;46m\1\\e[0m\2\3|' \
  -e 's|\(Repository revision:.*\)\(/.*\)|\1\\n|' &gt; ${TMPFILE}.mod 2&gt;&amp;1
echo "" &gt;&gt; ${TMPFILE}.mod
cat ${TMPFILE} | grep "^\?" | grep "\.[ch]$" &gt;&gt; ${TMPFILE}.mod
sed -i -e 's/\t/\\t/g' \
  -e 's/^\? \(.*\)$/\\bNOT TRAKING: \\e[0;1;33;46m\1\\e[0m/' \
  -e 's/$/\\n/' ${TMPFILE}.mod
echo -e `cat -v ${TMPFILE}.mod`
rm -f ${TMPFILE} ${TMPFILE}.mod{% endcodeblock %}
